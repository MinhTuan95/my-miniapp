<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Flutter Web + JS Interop</title>
  <meta name="description" content="Test JS and Flutter interop with permissions">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Yêu cầu quyền -->
  <meta name="permissions-policy" content="camera=*, microphone=*, geolocation=*, clipboard-read=*, clipboard-write=*">
  
  <!-- Cho phép truy cập camera và mic -->
  <meta http-equiv="Permissions-Policy" content="camera=(), microphone=(), geolocation=(), clipboard-read=(), clipboard-write=()">

  <script>
    // Hàm JS được Flutter gọi
    function showAlertFromJS(message) {
      alert("JS Received: " + message);
    }

    // JS gọi ngược lại Flutter
    function callFlutter() {
      if (window.flutterInterop) {
        window.flutterInterop("Hello from JS to Flutter!");
      }
    }

    // Kiểm tra quyền truy cập camera
    async function requestCamera() {
      try {
        const stream = await navigator.mediaDevices.getUserMedia({ video: true });
        alert("Camera access granted");
        stream.getTracks().forEach(track => track.stop());
      } catch (err) {
        alert("Camera access denied: " + err);
      }
    }

    // Kiểm tra quyền truy cập microphone
    async function requestMicrophone() {
      try {
        const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
        alert("Microphone access granted");
        stream.getTracks().forEach(track => track.stop());
      } catch (err) {
        alert("Microphone access denied: " + err);
      }
    }

    // Kiểm tra quyền truy cập vị trí
    function requestGeolocation() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
          pos => alert("Geolocation granted: " + pos.coords.latitude + ", " + pos.coords.longitude),
          err => alert("Geolocation denied: " + err.message)
        );
      } else {
        alert("Geolocation not supported");
      }
    }

    // Kiểm tra quyền truy cập clipboard
    async function requestClipboardRead() {
      try {
        const text = await navigator.clipboard.readText();
        alert("Clipboard content: " + text);
      } catch (err) {
        alert("Clipboard read denied: " + err);
      }
    }

    async function requestClipboardWrite() {
      try {
        await navigator.clipboard.writeText("Copied from JS");
        alert("Clipboard write success");
      } catch (err) {
        alert("Clipboard write denied: " + err);
      }
    }
  </script>
</head>
<body>
  <script src="main.dart.js" type="application/javascript"></script>
</body>
</html>